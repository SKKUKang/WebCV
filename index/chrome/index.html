<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chrome Extension</title>
    <link rel="stylesheet" href="style.css">
    <a href="../index.html" style="position: fixed; top: 10px; left: 10px; width: 30px;">
        <img src="../../image/home.png" alt="Home" style="width: 100%; height: auto; display: block;">
    </a>
</head>
   
    <body>
<div>
<h3 data-ke-size="size23"><span style="color: #f89009;"><span style="color: #92d050;">완성된 모습!</span></span></h3>
<img src = "../../image/스토어 등록 모습.png"></a> 
<h1><span style="color: green;">기획단계</span></h1>
<h3 data-ke-size="size23"><span style="color: #f89009;">개발하려고 하는 것</span></h3>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>chat gpt가 코드를 짜줄 때 copy code 버튼이 아래에도 생기도록 하는 크롬 익스텐션</li>
</ul>
<h3 data-ke-size="size23"><span style="color: #f89009;">개발하고자 하는 이유</span></h3>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<p>&nbsp;코드를 생성할 때 위에서부터 아래로 코드를 읽고 이해한 후에 복사해야 하는데, 코드가 길 경우 스크롤을 내려야만 코드 하단에 있는 복사 버튼을 눌러야 하는 불편함이 있다. 이 익스텐션은 이런 불편함을 해소하기 위해 코드 하단에도 복사 버튼을 추가한다.
    사실 대부분의 언어는 그렇게 까지 코드가 길지 않다. 그래서 필요성을 잘 느끼지 못했었다. 그런데 flutter은 dart라는 언어로 괄호로 둘러싼 위젯기반 언어여서, 코드 줄 수가 많다. gpt로 flutter로 앱 개발을 하는데 별거 아닌 코드들도 엄청 길어져서 필요성을 느끼게 되었다.</p>
</ul>
<h3 data-ke-size="size23"><span style="color: #f89009;">아이디어를 참고할 수 있는 것</span></h3>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>크롬 익스텐션 스토어에 비슷한 기능을 하는 다른 프로그램이 있나 찾으려 했으나 찾지 못했다. 그래서 다른 것 참고하지 않고 만들려고 했다.</li>
</ul>
<h3 data-ke-size="size23"><span style="color: #f89009;">생산성을 위해 알아두면 좋은것</span></h3>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>크롬 익스텐션 간의 상호 작동 원리</li>
<li>개발자 도구를 이용한 디버깅 및 확인 방법</li>
</ul>
<h3 data-ke-size="size23"><span style="color: #f89009;">사용언어와 그 이유</span></h3>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>자바스크립트: 크롬 익스텐션을 만드려고 하는데, 크롬 익스텐션이 자바스크립트 기반으로 작동해서</li>
</ul>
<h3 data-ke-size="size23"><span style="color: #f89009;">사전지식수준</span></h3>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>웹 스크래퍼를 엑셀로 불러오는 것을 만들었던 적이 있다. html 코드를 자바스크립트로 불러오는 걸 해봤다.</li>
<li>자바스크립트 테트리스를 만들어 html, css, js 간의 통신에 대해 알고 있다.</li>
</ul>
<h3 data-ke-size="size23"><span style="color: #f89009;">예상 MVP 모델 및 아키텍처 구성</span></h3>
<img src = "../../image/예상된 아키텍쳐.png">
<h1><span style="color: green;">개발단계</span></h1>
<h3 data-ke-size="size23"><span style="color: #f89009;">개발 기간</span></h3>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>2024.02.05~2024.02.10</li>
</ul>
<h3 data-ke-size="size23"><span style="color: #f89009;">개발 일지</span></h3>
<table style="height: 526px;" data-ke-align="alignLeft">
<thead>
<tr style="height: 21px;">
<th style="height: 21px;"><b><i>날짜</i></b></th>
<th style="height: 21px;"><b><i>해낸 것</i></b></th>
<th style="height: 21px;"><b><i>해결할 것</i></b></th>
</tr>
</thead>
<tbody>
<tr style="height: 60px;">
<td style="height: 60px;">02.05</td>
<td style="height: 60px;">크롬 익스텐션에서 일단 해당 코드를 콘솔창에 실행했을때 나오게는 했다. modifyHTML()함수 개발 완료</td>
<td style="height: 60px;">콘솔창에 코드 삽입 안됨, copy code 버튼 너무 큼, 콘솔창 외 에서의 실행, copy code 우측 정렬, copy code 버튼과 글자사이의 간격, 복사가 때로는 안됨</td>
</tr>
<tr style="height: 34px;">
<td style="height: 34px;">02.06</td>
<td style="height: 34px;">popup창 틀 만듬</td>
<td style="height: 34px;">popup창 다른 파일들과 상호작용 제대로 안되는 문제 해결할 것</td>
</tr>
<tr style="height: 60px;">
<td style="height: 60px;">02.07</td>
<td style="height: 60px;">익스텐션에 대한 이해 완료 해서, 팝업창에 따라 하단의 code copy 버튼 생성 및 삭제 기능 구현 완료</td>
<td style="height: 60px;">copy 버튼이 팝업창을 여러번 누르면 여러개 생긴다. 그리고 현재 활성화 여부가 저장이 안된다. 만약 현재 활성화 되어있다면 실시간으로 생성하는 코드에도 copy 버튼 생성하게 할것</td>
</tr>
<tr style="height: 60px;">
<td style="height: 60px;">02.08</td>
<td style="height: 60px;">이미 copy button이 있다면 버튼을 눌러도 중복으로 생기지 않도록 했다. 또한 현재 activate 상태인지 deactive 상태인지 저장하고 팝업창에 반영하였다.</td>
<td style="height: 60px;">activate 상태라면 실시간으로 code 밑에 copy button붙일것</td>
</tr>
<tr style="height: 257px;">
<td style="height: 257px;">02.09</td>
<td style="height: 257px;">실시간 반영여부에 따른 copy 버튼 생성, 그 과정에서 생긴 copy button 여러개 생기는 문제 flag 세워도 안되어서 강제로 지워주는 방식으로 해결<br />- 탭들 간 통신 리팩토링<br />- copy button 색깔 및 위치 맞추기<br />- mutation의 추적 대상 줄이기<br />- response 없앰으로써 그냥 계속 뜨는 Unchecked runtime.lastError: The message port closed before a response was received 에러 해결<br />- ui디자인 radio에서 버튼식으로 변경<br />- 권한 최소화 및 background 파일 삭제<br />- 크롬 익스텐션 파일 부분 완성<br />- icon 결정 및 편집 완료</td>
<td style="height: 257px;">popup창 디자인 변경할 것</td>
</tr>
<tr style="height: 34px;">
<td style="height: 34px;">02.10</td>
<td style="height: 34px;">팝업창 디자인 변경, 불필요한 권한 삭제</td>
<td style="height: 34px;">&nbsp;</td>
</tr>
</tbody>
</table>
<h3 data-ke-size="size23"><span style="color: #f89009;">기획에서 발견된 문제점과 개선방안</span></h3>
<h4 data-ke-size="size20">popup창의 radio 버튼이 현재 상태를 나타내주어야 하나, 간혹 현재 상태와 다른 곳에 checked 되어 있다.</h4>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>개발할 때 popup창의 radio 버튼이 사전에 checked 되어 있는 곳이 현재 activate 되어있는지 deactive 되어있는지 여부를 나타내는 일종의 토글 UI처럼 작동하기를 바랐다. 그래서 활성화 여부를 background.js에 저장하고 이를 popup창을 열떄마다 popup.js에서 불러와 현재 상태를 checked로 표시하길 바랬다. 그리고 실제로 이 부분을 구현하는데 많은 시간을 쏟았다. 하지만 기획 자체의 근본적인 문제가 있었다. 크롬 익스텐션에서 background.js 파일은 오랫동안 대기상태로 둘 때 자체적으로 종료된다는 것이다!! 즉 창을 열어두고 5분 정도가 지나면 background.js의 파일에 저장해 둔 현재상태에 대한 변수는 리셋된다.</li>
<li>그래서 현재 상태를 나타내는 radio 버튼을 일반 버튼 2개(활성화시키기, 비활성화시키기)로 바꾸었다.</li>
<li>background.js의 역할은 활성화, 비활성화 변수를 주는 역할이었는데 이젠 아무런 쓸모가 없게 되었다. 그래서 파일 자체를 마지막에 삭제했다. 원래는 background.js 에 뭐가 많았는데.. 사실 없어도 되는 파일이었다니 아쉬웠다.</li>
</ul>
<h3 data-ke-size="size23"><span style="color: #f89009;">개발 중 발생한 문제점과 개선방안</span></h3>
<h4 data-ke-size="size20"><span style="color: #006dd7;">popup.html에서 CSP 오류 발생</span></h4>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>크롬 익스텐션에서는 html안에 직접 스크립트를 입력하는 inline스크립트를 막는다. 그래서 모든 코드를 popup.js로 넘겨서 처리했다.</li>
</ul>
<h4 data-ke-size="size20"><span style="color: #006dd7;">하단에 새롭게 만든 code copy버튼이 원래 있던 copy 버튼과 디자인이 달라 위화감이 든다.</span></h4>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>html에서 원래 상단의 code copy 버튼은 중간의 code와는 별도의 div로 되어 있었다. 그런데 내가 새로 만든 하단의 code copy 버튼은 중간의 code 와 같은 /div 안에 있어 생겨난 문제였다. 즉, 중단의 code의 css를 적용받았던 것이다. 그래서 별도의 태그로 분리해 주었다.</li>
<li>그 외에도 code copy 버튼의 정렬, 글자크기, 아이콘 등이 기존 버튼의 html 버튼을 그대로 복사했음에도 달랐다. 따라서 기존 html에서 여러 클래스 중 디자인적으로 불필요한 class와 필요한 class를 구분하여 필요한 것만 적용하였다. 아이콘 같은 경우 불러올 수 있는 것은 아이콘을 쓰고, check표시의 경우 비슷한 모양의 아이콘을 사용했다.</li>
</ul>
<h4 data-ke-size="size20"><span style="color: #006dd7;">code copy 버튼이 활성화 버튼을 누를 때마다 중복으로 생긴다.</span></h4>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>modifyHTML()로 code copy 버튼을 하단에 추가할 때마다 고유 class를 추가하였고, 이후 해당 class가 없는 것들에만 하단에 copy 버튼을 추가하도록 하였다.</li>
</ul>
<h4 data-ke-size="size20"><span style="color: #006dd7;">활성화 상태에서 실시간으로 만들어지는 코드에 code copy 버튼이 중복으로 생긴다.</span></h4>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>코드를 수정해 주는 modifyHTML() 함수가 실행 중 또 호출스택에 올라가 중복으로 실행되어 발생하는 문제라고 생각했다. 그래서 전역변수를 flag 변수로 사용해보기도 하고, setTimeout() 함수로 시간을 조정해보기도 했다. 하지만 그래도 해결되지 않아서 일단 중복으로 code copy 버튼이 생길 때 지워주는 코드를 넣어주었다. 효율적인 해결책은 아니었다. 그런데 이런 문제가 왜 생기는지는 아직까지도 모르겠다. 지금은 네트워크 상태에 따라 생기는 문제 같다고 추측하고 있다.</li>
</ul>
<h3 data-ke-size="size23"><span style="color: #f89009;">개발 외에 해야 할 일들</span></h3>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>크롬 익스텐션 개발자 등록하기: 해외 결제가 가능한 카드로 5달러를 지불해야 한다. 개발자 계정을 등록하는 데 있어서 한국이 없어서 다른 나라로 등록했다.</li>
</ul>
<h1><span style="color: green;">이후 단계</span></h1>
<h3 data-ke-size="size23"><span style="color: #f89009;">완성된 화면 구성(캡처)</span></h3>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>다음과 같은 팝업창이 나와 활성화, 비활성화 버튼을 누를 수 있다.</li>
</ul>
<img src = "../../image/사용 창.png">
<p data-ke-size="size16">활성화 버튼을 누르면 다음 상태에서</p>
<img src = "../../image/익스텐션 사용 전.png">
<p data-ke-size="size16">다음과 같이 변한다</p>
<img src = "../../image/익스텐션 사용후.png">
<p data-ke-size="size16"><br />하단에 copy code 버튼이 생겼음을 알 수 있다.</p>
<img src = "../../image/사용후 2.png">
<p data-ke-size="size16"><br />새로 생긴 copy code 버튼을 누르면 버튼이 바뀌는 피드백이 있으며 제대로 복사되어 잘 작동한다.</p>
<h3 data-ke-size="size23"><span style="color: #f89009;">아키텍처 구성(그림)</span></h3>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>background.js를 빼자 불필요한 통신도 줄고 아키텍처도 간단해졌다.</li>
</ul>
<img src = "../../image/실제 아키텍쳐.png">
<h3 data-ke-size="size23"><span style="color: #f89009;">개제된 사이트</span></h3>
<p data-ke-size="size16"><span style="color: #f89009;">크롬 확장 프로그램 링크</span></p>
<h3 style="color: #000000; text-align: start;" data-ke-size="size23"><span style="color: #f89009;"><a href="https://chromewebstore.google.com/detail/gptbottomcopybutton/onepocigimnaipfleflfbfoiekjgojoh?hl=ko&amp;authuser=0">크롬 익스텐션 링크</a></span></h3>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16"><span style="color: #f89009;">깃허브 링크</span></p>
<h3 data-ke-size="size23"><a href="https://github.com/SKKUKang/gpt-code-copy-button-below" target="_blank" rel="noopener&nbsp;noreferrer">https://github.com/SKKUKang/gpt-code-copy-button-below</a></h3>
</div>
</a></figure>

</div>
</body>
</html>
